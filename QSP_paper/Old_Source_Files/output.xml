<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/Users/rwx/QC/QC/QIP_paper"?>
<?latexml class="article"?>
<?latexml package="geometry" options="margin=1in"?>
<?latexml package="braket"?>
<?latexml package="amsmath"?>
<?latexml package="graphicx"?>
<?latexml graphicspath="/Users/rwx/QC/QC/QIP_paper/ {./figures} "?>
<?latexml RelaxNGSchema="LaTeXML"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_authors_1line">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <title>Revised algorithm description section</title>
  <section inlist="toc" xml:id="S1">
    <tags>
      <tag>1</tag>
      <tag role="refnum">1</tag>
      <tag role="typerefnum">§1</tag>
    </tags>
    <title><tag close=" ">1</tag>ISA framework, formal description and implementation</title>
    <para xml:id="S1.p1">
      <p>In this work, we propose an approximate quantum state preparation framework,
which we call “Iterative Sparse Approximation” (ISA). Let the target state be
<Math mode="inline" tex="\ket{x_{0}}" text="ket@(x _ 0)" xml:id="S1.p1.m1">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p1.m1.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p1.m1.1">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>. Then the ISA framework transforms <Math mode="inline" tex="\ket{x_{0}}" text="ket@(x _ 0)" xml:id="S1.p1.m2">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p1.m2.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p1.m2.1">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> to
<Math mode="inline" tex="\ket{x_{1}}" text="ket@(x _ 1)" xml:id="S1.p1.m3">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p1.m3.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p1.m3.1">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>, then <Math mode="inline" tex="\ket{x_{1}}" text="ket@(x _ 1)" xml:id="S1.p1.m4">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p1.m4.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p1.m4.1">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> to <Math mode="inline" tex="\ket{x_{2}}" text="ket@(x _ 2)" xml:id="S1.p1.m5">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p1.m5.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p1.m5.1">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>, and so on, until it reaches some
state <Math mode="inline" tex="\ket{x_{m}}" text="ket@(x _ m)" xml:id="S1.p1.m6">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p1.m6.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p1.m6.1">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>, such that</p>
      <equation xml:id="S1.Ex1">
        <Math mode="display" tex="|\braket{0}{x_{0}}|^{2}&lt;|\braket{0}{x_{1}}|^{2}&lt;...&lt;|\braket{0}{x_{m}}|^{2}" text="(absolute-value@(inner-product@(0, x _ 0))) ^ 2 &lt; (absolute-value@(inner-product@(0, x _ 1))) ^ 2 &lt; ldots &lt; (absolute-value@(inner-product@(0, x _ m))) ^ 2" xml:id="S1.Ex1.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="multirelation"/>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="S1.Ex1.m1.7"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMDual xml:id="S1.Ex1.m1.7">
                      <XMApp>
                        <XMTok meaning="inner-product" name="braket" role="UNKNOWN"/>
                        <XMRef idref="S1.Ex1.m1.1"/>
                        <XMRef idref="S1.Ex1.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok name="langle" role="OPEN" stretchy="false">⟨</XMTok>
                        <XMTok meaning="0" role="NUMBER" rpadding="1.7pt" xml:id="S1.Ex1.m1.1">0</XMTok>
                        <XMTok role="MIDDLE" rpadding="1.7pt" stretchy="false">|</XMTok>
                        <XMApp xml:id="S1.Ex1.m1.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                        </XMApp>
                        <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
              <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="S1.Ex1.m1.8"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMDual xml:id="S1.Ex1.m1.8">
                      <XMApp>
                        <XMTok meaning="inner-product" name="braket" role="UNKNOWN"/>
                        <XMRef idref="S1.Ex1.m1.3"/>
                        <XMRef idref="S1.Ex1.m1.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok name="langle" role="OPEN" stretchy="false">⟨</XMTok>
                        <XMTok meaning="0" role="NUMBER" rpadding="1.7pt" xml:id="S1.Ex1.m1.3">0</XMTok>
                        <XMTok role="MIDDLE" rpadding="1.7pt" stretchy="false">|</XMTok>
                        <XMApp xml:id="S1.Ex1.m1.4">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
              <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
              <XMTok name="ldots" role="ID">…</XMTok>
              <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="S1.Ex1.m1.9"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMDual xml:id="S1.Ex1.m1.9">
                      <XMApp>
                        <XMTok meaning="inner-product" name="braket" role="UNKNOWN"/>
                        <XMRef idref="S1.Ex1.m1.5"/>
                        <XMRef idref="S1.Ex1.m1.6"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok name="langle" role="OPEN" stretchy="false">⟨</XMTok>
                        <XMTok meaning="0" role="NUMBER" rpadding="1.7pt" xml:id="S1.Ex1.m1.5">0</XMTok>
                        <XMTok role="MIDDLE" rpadding="1.7pt" stretchy="false">|</XMTok>
                        <XMApp xml:id="S1.Ex1.m1.6">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                        </XMApp>
                        <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>
      </equation>
      <p>And</p>
      <equation xml:id="S1.Ex2">
        <Math mode="display" tex="|\braket{0}{x_{m}}|^{2}\geq 1-\epsilon" text="(absolute-value@(inner-product@(0, x _ m))) ^ 2 &gt;= 1 - epsilon" xml:id="S1.Ex2.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="S1.Ex2.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMDual xml:id="S1.Ex2.m1.3">
                      <XMApp>
                        <XMTok meaning="inner-product" name="braket" role="UNKNOWN"/>
                        <XMRef idref="S1.Ex2.m1.1"/>
                        <XMRef idref="S1.Ex2.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok name="langle" role="OPEN" stretchy="false">⟨</XMTok>
                        <XMTok meaning="0" role="NUMBER" rpadding="1.7pt" xml:id="S1.Ex2.m1.1">0</XMTok>
                        <XMTok role="MIDDLE" rpadding="1.7pt" stretchy="false">|</XMTok>
                        <XMApp xml:id="S1.Ex2.m1.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                        </XMApp>
                        <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
                <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>
      </equation>
      <p>Each transformation from <Math mode="inline" tex="\ket{x_{i}}" text="ket@(x _ i)" xml:id="S1.p1.m7">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p1.m7.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p1.m7.1">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> to <Math mode="inline" tex="\ket{x_{i+1}}" text="ket@(x _ (i + 1))" xml:id="S1.p1.m8">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p1.m8.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p1.m8.1">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> generates a state
closer to <Math mode="inline" tex="\ket{0}" text="ket@(0)" xml:id="S1.p1.m9">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p1.m9.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMTok meaning="0" role="NUMBER" xml:id="S1.p1.m9.1">0</XMTok>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>; these steps are called “refinements.” The sequence
of gates used in each refinement step are combined to create the
<!--  %**** algo˙desc.tex Line 25 **** -->state preparation sequence for <Math mode="inline" tex="\ket{x_{0}}" text="ket@(x _ 0)" xml:id="S1.p1.m10">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p1.m10.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p1.m10.1">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>.</p>
    </para>
    <para xml:id="S1.p2">
      <p>To refine <Math mode="inline" tex="\ket{x}" text="ket@(x)" xml:id="S1.p2.m1">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p2.m1.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S1.p2.m1.1">x</XMTok>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>, the
ISA framework selects an index subset <Math class="ltx_math_unparsed" mode="inline" tex="K\subset\{0,,,2^{n}-1\}" xml:id="S1.p2.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">K</XMTok>
            <XMTok meaning="subset-of" name="subset" role="RELOP">⊂</XMTok>
            <XMWrap>
              <XMTok role="OPEN" stretchy="false">{</XMTok>
              <XMTok meaning="0" role="NUMBER">0</XMTok>
              <XMTok role="PUNCT">,</XMTok>
              <XMTok role="PUNCT">,</XMTok>
              <XMTok role="PUNCT">,</XMTok>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
              <XMTok meaning="minus" role="ADDOP">-</XMTok>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
              <XMTok role="CLOSE" stretchy="false">}</XMTok>
            </XMWrap>
          </XMath>
        </Math>
and constructs the sparse, usually non-normalized approximation</p>
      <equation xml:id="S1.Ex3">
        <Math mode="display" tex="\ket{x}\approx\ket{x^{\prime}}=\sum_{k\in K}{\braket{k}{x}}" text="ket@(x) approximately-equals ket@(x ^ prime) = (sum _ (k element-of K))@(inner-product@(k, x))" xml:id="S1.Ex3.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="multirelation"/>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.Ex3.m1.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex3.m1.1">x</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
              <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.Ex3.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.Ex3.m1.2">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                  </XMApp>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="inner-product" name="braket" role="UNKNOWN"/>
                    <XMRef idref="S1.Ex3.m1.3"/>
                    <XMRef idref="S1.Ex3.m1.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok name="langle" role="OPEN" stretchy="false">⟨</XMTok>
                    <XMTok font="italic" role="UNKNOWN" rpadding="1.7pt" xml:id="S1.Ex3.m1.3">k</XMTok>
                    <XMTok role="MIDDLE" rpadding="1.7pt" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex3.m1.4">x</XMTok>
                    <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>
      </equation>
      <p>If <Math mode="inline" tex="\ket{x}=\sum_{i=0}^{2^{n}-1}{c_{i}\ket{i}}" text="ket@(x) = ((sum _ (i = 0)) ^ (2 ^ n - 1))@(c _ i * ket@(i))" xml:id="S1.p2.m3">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.p2.m3.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S1.p2.m3.1">x</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
              <XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">n</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="ket" role="UNKNOWN"/>
                      <XMRef idref="S1.p2.m3.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S1.p2.m3.2">i</XMTok>
                      <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>, then
<Math mode="inline" tex="\ket{x^{\prime}}=\sum_{k\in K}{c_{k}\ket{k}}" text="ket@(x ^ prime) = (sum _ (k element-of K))@(c _ k * ket@(k))" xml:id="S1.p2.m4">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.p2.m4.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.p2.m4.1">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
              <XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="ket" role="UNKNOWN"/>
                      <XMRef idref="S1.p2.m4.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S1.p2.m4.2">k</XMTok>
                      <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>, showing that <Math mode="inline" tex="\ket{x^{\prime}}" text="ket@(x ^ prime)" xml:id="S1.p2.m5">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p2.m5.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p2.m5.1">
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> has at
most <Math mode="inline" tex="|K|" text="absolute-value@(K)" xml:id="S1.p2.m6">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="absolute-value"/>
                <XMRef idref="S1.p2.m6.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S1.p2.m6.1">K</XMTok>
                <XMTok role="CLOSE" stretchy="false">|</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> non-zero elements and is therefore sparse.</p>
    </para>
    <para xml:id="S1.p3">
      <p>Next, the sparse state preparation method for <Math mode="inline" tex="\ket{x^{\prime}}" text="ket@(x ^ prime)" xml:id="S1.p3.m1">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p3.m1.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p3.m1.1">
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>
is adapted towards the refinement of <Math mode="inline" tex="\ket{x}" text="ket@(x)" xml:id="S1.p3.m2">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p3.m2.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S1.p3.m2.1">x</XMTok>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>. Because <Math mode="inline" tex="\ket{x^{\prime}}" text="ket@(x ^ prime)" xml:id="S1.p3.m3">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p3.m3.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p3.m3.1">
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>
approximates <Math mode="inline" tex="\ket{x}" text="ket@(x)" xml:id="S1.p3.m4">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p3.m4.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S1.p3.m4.1">x</XMTok>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>, the state preparation sequence for
<Math mode="inline" tex="\ket{x^{\prime}}" text="ket@(x ^ prime)" xml:id="S1.p3.m5">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p3.m5.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p3.m5.1">
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> approximately prepares <Math mode="inline" tex="\ket{x}" text="ket@(x)" xml:id="S1.p3.m6">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p3.m6.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S1.p3.m6.1">x</XMTok>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>. However, <Math mode="inline" tex="\ket{x^{\prime}}" text="ket@(x ^ prime)" xml:id="S1.p3.m7">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p3.m7.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p3.m7.1">
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> and
<Math mode="inline" tex="\ket{x}" text="ket@(x)" xml:id="S1.p3.m8">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p3.m8.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S1.p3.m8.1">x</XMTok>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> are not the same state, motivating the need for an adaptation step.
Index subset selection <Math mode="inline" tex="K" text="K" xml:id="S1.p3.m9">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">K</XMTok>
          </XMath>
        </Math> (“Select”), constructing and preparing <Math mode="inline" tex="\ket{x^{\prime}}" text="ket@(x ^ prime)" xml:id="S1.p3.m10">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p3.m10.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p3.m10.1">
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>
(“Prepare”), and adapting the state preparation sequence for <Math mode="inline" tex="\ket{x^{\prime}}" text="ket@(x ^ prime)" xml:id="S1.p3.m11">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p3.m11.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p3.m11.1">
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> to
refine <Math mode="inline" tex="\ket{x}" text="ket@(x)" xml:id="S1.p3.m12">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p3.m12.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S1.p3.m12.1">x</XMTok>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> (“Adapt”) constitute the central steps in the ISA framework,
as shown in Algorithm 1.</p>
    </para>
    <para xml:id="S1.p4">
      <graphics candidates="isa_algo.png" graphic="isa_algo" options="width=346.89731pt" xml:id="S1.p4.g1"/>
    </para>
    <para xml:id="S1.p5">
      <p>In the remainder of this
section, we describe our specific implementation of the ISA framework for linear
nearest neighbor architectures. In section x.1, we describe the two types of
<!--  %**** algo˙desc.tex Line 50 **** -->index subsets <Math mode="inline" tex="K" text="K" xml:id="S1.p5.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">K</XMTok>
          </XMath>
        </Math> considered for the Select step, as well as the procedure for
choosing one. In section x.2, we describe our implementation of the Prepare step
for each index subset type. In section x.3, describe our implementation of the
Adapt step. Finally, in section x.4, we describe an additional step in our
implementation,
called “Refinement by RZ-RY,” in which the starting state <Math mode="inline" tex="\ket{x_{0}}" text="ket@(x _ 0)" xml:id="S1.p5.m2">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p5.m2.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p5.m2.1">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> is first
refined to <Math mode="inline" tex="\ket{x_{1}}" text="ket@(x _ 1)" xml:id="S1.p5.m3">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ket" role="UNKNOWN"/>
                <XMRef idref="S1.p5.m3.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">|</XMTok>
                <XMApp xml:id="S1.p5.m3.1">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> using RZ and RY gates before applying the ISA framework.</p>
    </para>
    <subsection inlist="toc" xml:id="S1.SS1">
      <tags>
        <tag>1.1</tag>
        <tag role="refnum">1.1</tag>
        <tag role="typerefnum">§1.1</tag>
      </tags>
      <title><tag close=" ">1.1</tag>Index subsets and implementing Select</title>
      <para xml:id="S1.SS1.p1">
        <p>Type 1 index subsets are those of the form:</p>
        <equation xml:id="S1.Ex4">
          <Math mode="display" tex="K(b)=\{0,b\}" text="K * b = set@(0, b)" xml:id="S1.Ex4.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">K</XMTok>
                  <XMDual>
                    <XMRef idref="S1.Ex4.m1.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex4.m1.1">b</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S1.Ex4.m1.2"/>
                    <XMRef idref="S1.Ex4.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S1.Ex4.m1.2">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex4.m1.3">b</XMTok>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>For some <Math mode="inline" tex="b" text="b" xml:id="S1.SS1.p1.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">b</XMTok>
            </XMath>
          </Math> between 1 and <Math mode="inline" tex="2^{n}-1" text="2 ^ n - 1" xml:id="S1.SS1.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> inclusive.</p>
      </para>
      <para xml:id="S1.SS1.p2">
        <p>Type 2 index subsets take one of two different forms:</p>
        <equation xml:id="S1.Ex5">
          <Math mode="display" tex="K^{(+)}(a,p)=\{a*2^{p+2}+i*2^{p}|0\leq i\leq 3\}\cup\{i*2^{p}|0\leq i\leq 3\}" text="K ^ + * open-interval@(a, p) = conditional-set@(a * 2 ^ (p + 2) + i * 2 ^ p, 0 &lt;= i &lt;= 3) union conditional-set@(i * 2 ^ p, 0 &lt;= i &lt;= 3)" xml:id="S1.Ex5.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">K</XMTok>
                    <XMDual>
                      <XMRef idref="S1.Ex5.m1.1"/>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok fontsize="70%" meaning="plus" role="ADDOP" xml:id="S1.Ex5.m1.1">+</XMTok>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S1.Ex5.m1.2"/>
                      <XMRef idref="S1.Ex5.m1.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex5.m1.2">a</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex5.m1.3">p</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="conditional-set"/>
                      <XMRef idref="S1.Ex5.m1.4"/>
                      <XMRef idref="S1.Ex5.m1.5"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="S1.Ex5.m1.4">
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">*</XMTok>
                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">*</XMTok>
                          <XMTok font="italic" role="UNKNOWN">i</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="MIDDLE" stretchy="false">|</XMTok>
                      <XMApp xml:id="S1.Ex5.m1.5">
                        <XMTok meaning="multirelation"/>
                        <XMTok meaning="0" role="NUMBER">0</XMTok>
                        <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                        <XMTok font="italic" role="UNKNOWN">i</XMTok>
                        <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                        <XMTok meaning="3" role="NUMBER">3</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="conditional-set"/>
                      <XMRef idref="S1.Ex5.m1.6"/>
                      <XMRef idref="S1.Ex5.m1.7"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="S1.Ex5.m1.6">
                        <XMTok meaning="times" role="MULOP">*</XMTok>
                        <XMTok font="italic" role="UNKNOWN">i</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="MIDDLE" stretchy="false">|</XMTok>
                      <XMApp xml:id="S1.Ex5.m1.7">
                        <XMTok meaning="multirelation"/>
                        <XMTok meaning="0" role="NUMBER">0</XMTok>
                        <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                        <XMTok font="italic" role="UNKNOWN">i</XMTok>
                        <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                        <XMTok meaning="3" role="NUMBER">3</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <equation xml:id="S1.Ex6">
          <Math mode="display" tex="K^{(-)}(a,p)=\{a+i*2^{p}|0\leq i\leq 3\}\cup\{i*2^{p}|0\leq i\leq 3\}" text="K ^ - * open-interval@(a, p) = conditional-set@(a + i * 2 ^ p, 0 &lt;= i &lt;= 3) union conditional-set@(i * 2 ^ p, 0 &lt;= i &lt;= 3)" xml:id="S1.Ex6.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">K</XMTok>
                    <XMDual>
                      <XMRef idref="S1.Ex6.m1.1"/>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP" xml:id="S1.Ex6.m1.1">-</XMTok>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S1.Ex6.m1.2"/>
                      <XMRef idref="S1.Ex6.m1.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex6.m1.2">a</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex6.m1.3">p</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="conditional-set"/>
                      <XMRef idref="S1.Ex6.m1.4"/>
                      <XMRef idref="S1.Ex6.m1.5"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="S1.Ex6.m1.4">
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">*</XMTok>
                          <XMTok font="italic" role="UNKNOWN">i</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="MIDDLE" stretchy="false">|</XMTok>
                      <XMApp xml:id="S1.Ex6.m1.5">
                        <XMTok meaning="multirelation"/>
                        <XMTok meaning="0" role="NUMBER">0</XMTok>
                        <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                        <XMTok font="italic" role="UNKNOWN">i</XMTok>
                        <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                        <XMTok meaning="3" role="NUMBER">3</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="conditional-set"/>
                      <XMRef idref="S1.Ex6.m1.6"/>
                      <XMRef idref="S1.Ex6.m1.7"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="S1.Ex6.m1.6">
                        <XMTok meaning="times" role="MULOP">*</XMTok>
                        <XMTok font="italic" role="UNKNOWN">i</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="MIDDLE" stretchy="false">|</XMTok>
                      <XMApp xml:id="S1.Ex6.m1.7">
                        <XMTok meaning="multirelation"/>
                        <XMTok meaning="0" role="NUMBER">0</XMTok>
                        <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                        <XMTok font="italic" role="UNKNOWN">i</XMTok>
                        <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                        <XMTok meaning="3" role="NUMBER">3</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>For some <Math mode="inline" tex="a" text="a" xml:id="S1.SS1.p2.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">a</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="p" text="p" xml:id="S1.SS1.p2.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
            </XMath>
          </Math>. For the <Math mode="inline" tex="K^{(+)}" text="K ^ +" xml:id="S1.SS1.p2.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
                <XMDual>
                  <XMRef idref="S1.SS1.p2.m3.1"/>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP" xml:id="S1.SS1.p2.m3.1">+</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> case, <Math mode="inline" tex="0\leq a\leq 2^{n-p-2}-1" text="0 &lt;= a &lt;= 2 ^ (n - p - 2) - 1" xml:id="S1.SS1.p2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>;
in the <Math mode="inline" tex="K^{(-)}" text="K ^ -" xml:id="S1.SS1.p2.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
                <XMDual>
                  <XMRef idref="S1.SS1.p2.m5.1"/>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP" xml:id="S1.SS1.p2.m5.1">-</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> case, <Math mode="inline" tex="0\leq a\leq 2^{p}-1" text="0 &lt;= a &lt;= 2 ^ p - 1" xml:id="S1.SS1.p2.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                  </XMApp>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. In both cases, <Math mode="inline" tex="0\leq p\leq n-2" text="0 &lt;= p &lt;= n - 2" xml:id="S1.SS1.p2.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
When written in binary, the indices in <Math mode="inline" tex="K^{(+)}" text="K ^ +" xml:id="S1.SS1.p2.m8">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
                <XMDual>
                  <XMRef idref="S1.SS1.p2.m8.1"/>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP" xml:id="S1.SS1.p2.m8.1">+</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> subsets are those where the
left-most <Math mode="inline" tex="n-p-2" text="n - p - 2" xml:id="S1.SS1.p2.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> bits are either <Math mode="inline" tex="a" text="a" xml:id="S1.SS1.p2.m10">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">a</XMTok>
            </XMath>
          </Math> or zeroes, the right-most <Math mode="inline" tex="p" text="p" xml:id="S1.SS1.p2.m11">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
            </XMath>
          </Math> bits are
zeroes, and the middle two bits can be any length-2 bitstring, and the indices
in <Math mode="inline" tex="K^{(-)}" text="K ^ -" xml:id="S1.SS1.p2.m12">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
                <XMDual>
                  <XMRef idref="S1.SS1.p2.m12.1"/>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP" xml:id="S1.SS1.p2.m12.1">-</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> subsets are those where the left-most <Math mode="inline" tex="n-p-2" text="n - p - 2" xml:id="S1.SS1.p2.m13">
            <XMath>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> bits are zeroes,
the right-most <Math mode="inline" tex="p" text="p" xml:id="S1.SS1.p2.m14">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
            </XMath>
          </Math> bits are either <Math mode="inline" tex="a" text="a" xml:id="S1.SS1.p2.m15">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">a</XMTok>
            </XMath>
          </Math> or zeroes, and the middle two bits can be
any length-2 bitstring.</p>
      </para>
<!--  %**** algo˙desc.tex Line 75 **** -->      <para xml:id="S1.SS1.p3">
        <p>When refining a state <Math mode="inline" tex="\ket{x}" text="ket@(x)" xml:id="S1.SS1.p3.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS1.p3.m1.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p3.m1.1">x</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, each subset <Math mode="inline" tex="K" text="K" xml:id="S1.SS1.p3.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">K</XMTok>
            </XMath>
          </Math> corresponds to a non-normalized
sparse approximation <Math mode="inline" tex="\ket{x^{\prime}(K)}" text="ket@(x ^ prime * K)" xml:id="S1.SS1.p3.m3">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS1.p3.m3.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS1.p3.m3.1">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S1.SS1.p3.m3.1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p3.m3.1.1">K</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>. Let CX_count(<Math mode="inline" tex="K" text="K" xml:id="S1.SS1.p3.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">K</XMTok>
            </XMath>
          </Math>) be the number of CX gates
required to prepare <Math mode="inline" tex="\ket{x^{\prime}(K)}" text="ket@(x ^ prime * K)" xml:id="S1.SS1.p3.m5">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS1.p3.m5.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS1.p3.m5.1">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S1.SS1.p3.m5.1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p3.m5.1.1">K</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>. Then, at the Select step, we choose the index
subset <Math mode="inline" tex="K" text="K" xml:id="S1.SS1.p3.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">K</XMTok>
            </XMath>
          </Math> that maximizes the fidelity increase ratio:</p>
        <equation xml:id="S1.Ex7">
          <Math mode="display" tex="\text{fidelity increase ratio}(K)=\frac{\braket{x^{\prime}(K)}{x^{\prime}(K)}-%&#10;|\braket{0}{x}|^{2}}{\text{CX\_count}(K)+1}" text="[fidelity increase ratio] * K = (inner-product@(x ^ prime * K, x ^ prime * K) - (absolute-value@(inner-product@(0, x))) ^ 2) / ([CX_count] * K + 1)" xml:id="S1.Ex7.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>fidelity increase ratio</XMText>
                  <XMDual>
                    <XMRef idref="S1.Ex7.m1.7"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex7.m1.7">K</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                  <XMApp>
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="inner-product" name="braket" role="UNKNOWN"/>
                        <XMRef idref="S1.Ex7.m1.1"/>
                        <XMRef idref="S1.Ex7.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok name="langle" role="OPEN" stretchy="false">⟨</XMTok>
                        <XMApp rpadding="1.7pt" xml:id="S1.Ex7.m1.1">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S1.Ex7.m1.1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex7.m1.1.1">K</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="MIDDLE" rpadding="1.7pt" stretchy="false">|</XMTok>
                        <XMApp xml:id="S1.Ex7.m1.2">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S1.Ex7.m1.2.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex7.m1.2.1">K</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="absolute-value"/>
                          <XMRef idref="S1.Ex7.m1.5"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">|</XMTok>
                          <XMDual xml:id="S1.Ex7.m1.5">
                            <XMApp>
                              <XMTok meaning="inner-product" name="braket" role="UNKNOWN"/>
                              <XMRef idref="S1.Ex7.m1.3"/>
                              <XMRef idref="S1.Ex7.m1.4"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok name="langle" role="OPEN" stretchy="false">⟨</XMTok>
                              <XMTok meaning="0" role="NUMBER" rpadding="1.7pt" xml:id="S1.Ex7.m1.3">0</XMTok>
                              <XMTok role="MIDDLE" rpadding="1.7pt" stretchy="false">|</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex7.m1.4">x</XMTok>
                              <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok role="CLOSE" stretchy="false">|</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMText>CX_count</XMText>
                      <XMDual>
                        <XMRef idref="S1.Ex7.m1.6"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex7.m1.6">K</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>This quantity is named “fidelity increase ratio” because if <Math mode="inline" tex="\ket{y(K)}" text="ket@(y * K)" xml:id="S1.SS1.p3.m7">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS1.p3.m7.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS1.p3.m7.1">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">y</XMTok>
                    <XMDual>
                      <XMRef idref="S1.SS1.p3.m7.1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p3.m7.1.1">K</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> is the
state after applying the state preparation sequence of <Math mode="inline" tex="\ket{x^{\prime}(K)}" text="ket@(x ^ prime * K)" xml:id="S1.SS1.p3.m8">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS1.p3.m8.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS1.p3.m8.1">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S1.SS1.p3.m8.1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p3.m8.1.1">K</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> to
<Math mode="inline" tex="\ket{x}" text="ket@(x)" xml:id="S1.SS1.p3.m9">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS1.p3.m9.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p3.m9.1">x</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, then <Math mode="inline" tex="|\braket{0}{y(K)}|^{2}=\braket{x^{\prime}(K)}{x^{\prime}(K)}" text="(absolute-value@(inner-product@(0, y * K))) ^ 2 = inner-product@(x ^ prime * K, x ^ prime * K)" xml:id="S1.SS1.p3.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="absolute-value"/>
                      <XMRef idref="S1.SS1.p3.m10.5"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMDual xml:id="S1.SS1.p3.m10.5">
                        <XMApp>
                          <XMTok meaning="inner-product" name="braket" role="UNKNOWN"/>
                          <XMRef idref="S1.SS1.p3.m10.1"/>
                          <XMRef idref="S1.SS1.p3.m10.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok name="langle" role="OPEN" stretchy="false">⟨</XMTok>
                          <XMTok meaning="0" role="NUMBER" rpadding="1.7pt" xml:id="S1.SS1.p3.m10.1">0</XMTok>
                          <XMTok role="MIDDLE" rpadding="1.7pt" stretchy="false">|</XMTok>
                          <XMApp xml:id="S1.SS1.p3.m10.2">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">y</XMTok>
                            <XMDual>
                              <XMRef idref="S1.SS1.p3.m10.2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p3.m10.2.1">K</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok role="CLOSE" stretchy="false">|</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="inner-product" name="braket" role="UNKNOWN"/>
                    <XMRef idref="S1.SS1.p3.m10.3"/>
                    <XMRef idref="S1.SS1.p3.m10.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok name="langle" role="OPEN" stretchy="false">⟨</XMTok>
                    <XMApp rpadding="1.7pt" xml:id="S1.SS1.p3.m10.3">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="S1.SS1.p3.m10.3.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p3.m10.3.1">K</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="MIDDLE" rpadding="1.7pt" stretchy="false">|</XMTok>
                    <XMApp xml:id="S1.SS1.p3.m10.4">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="S1.SS1.p3.m10.4.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p3.m10.4.1">K</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, corresponding to a
fidelity increase of <Math mode="inline" tex="|\braket{0}{y(K)}|^{2}-|\braket{0}{x}|^{2}=\braket{x^{\prime}(K)}{x^{\prime}(K%&#10;)}-|\braket{0}{x}|^{2}" text="(absolute-value@(inner-product@(0, y * K))) ^ 2 - (absolute-value@(inner-product@(0, x))) ^ 2 = inner-product@(x ^ prime * K, x ^ prime * K) - (absolute-value@(inner-product@(0, x))) ^ 2" xml:id="S1.SS1.p3.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="absolute-value"/>
                        <XMRef idref="S1.SS1.p3.m11.9"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">|</XMTok>
                        <XMDual xml:id="S1.SS1.p3.m11.9">
                          <XMApp>
                            <XMTok meaning="inner-product" name="braket" role="UNKNOWN"/>
                            <XMRef idref="S1.SS1.p3.m11.1"/>
                            <XMRef idref="S1.SS1.p3.m11.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok name="langle" role="OPEN" stretchy="false">⟨</XMTok>
                            <XMTok meaning="0" role="NUMBER" rpadding="1.7pt" xml:id="S1.SS1.p3.m11.1">0</XMTok>
                            <XMTok role="MIDDLE" rpadding="1.7pt" stretchy="false">|</XMTok>
                            <XMApp xml:id="S1.SS1.p3.m11.2">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">y</XMTok>
                              <XMDual>
                                <XMRef idref="S1.SS1.p3.m11.2.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p3.m11.2.1">K</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok role="CLOSE" stretchy="false">|</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="absolute-value"/>
                        <XMRef idref="S1.SS1.p3.m11.10"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">|</XMTok>
                        <XMDual xml:id="S1.SS1.p3.m11.10">
                          <XMApp>
                            <XMTok meaning="inner-product" name="braket" role="UNKNOWN"/>
                            <XMRef idref="S1.SS1.p3.m11.3"/>
                            <XMRef idref="S1.SS1.p3.m11.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok name="langle" role="OPEN" stretchy="false">⟨</XMTok>
                            <XMTok meaning="0" role="NUMBER" rpadding="1.7pt" xml:id="S1.SS1.p3.m11.3">0</XMTok>
                            <XMTok role="MIDDLE" rpadding="1.7pt" stretchy="false">|</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p3.m11.4">x</XMTok>
                            <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok role="CLOSE" stretchy="false">|</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="inner-product" name="braket" role="UNKNOWN"/>
                      <XMRef idref="S1.SS1.p3.m11.5"/>
                      <XMRef idref="S1.SS1.p3.m11.6"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok name="langle" role="OPEN" stretchy="false">⟨</XMTok>
                      <XMApp rpadding="1.7pt" xml:id="S1.SS1.p3.m11.5">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S1.SS1.p3.m11.5.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p3.m11.5.1">K</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="MIDDLE" rpadding="1.7pt" stretchy="false">|</XMTok>
                      <XMApp xml:id="S1.SS1.p3.m11.6">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S1.SS1.p3.m11.6.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p3.m11.6.1">K</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="absolute-value"/>
                        <XMRef idref="S1.SS1.p3.m11.11"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">|</XMTok>
                        <XMDual xml:id="S1.SS1.p3.m11.11">
                          <XMApp>
                            <XMTok meaning="inner-product" name="braket" role="UNKNOWN"/>
                            <XMRef idref="S1.SS1.p3.m11.7"/>
                            <XMRef idref="S1.SS1.p3.m11.8"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok name="langle" role="OPEN" stretchy="false">⟨</XMTok>
                            <XMTok meaning="0" role="NUMBER" rpadding="1.7pt" xml:id="S1.SS1.p3.m11.7">0</XMTok>
                            <XMTok role="MIDDLE" rpadding="1.7pt" stretchy="false">|</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p3.m11.8">x</XMTok>
                            <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok role="CLOSE" stretchy="false">|</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. This improvement is divided by the
number of CX gates required to achieve it to compute the fidelity increase per
CX gate; +1 is added to the denominator to prevent division by zero. Thus, at
each step, <Math mode="inline" tex="K" text="K" xml:id="S1.SS1.p3.m12">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">K</XMTok>
            </XMath>
          </Math> is chosen to maximize the projected fidelity increase per CX
gate applied.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S1.SS2">
      <tags>
        <tag>1.2</tag>
        <tag role="refnum">1.2</tag>
        <tag role="typerefnum">§1.2</tag>
      </tags>
      <title><tag close=" ">1.2</tag>Implementing Prepare</title>
      <para xml:id="S1.SS2.p1">
        <p>Type 1 and Type 2 index subsets give rise to Type 1 and Type 2 sparse quantum
states. Our preparation method for these states is an extension of
[Gleinig and Hoefler] for limited connectivity architectures.</p>
      </para>
      <para xml:id="S1.SS2.p2">
        <p>Type 1 index subsets give rise to quantum states of the form</p>
        <equation xml:id="S1.Ex8">
          <Math mode="display" tex="\ket{x^{\prime}(b)}=c_{0}\ket{0}+c_{b}\ket{b}" text="ket@(x ^ prime * b) = c _ 0 * ket@(0) + c _ b * ket@(b)" xml:id="S1.Ex8.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="ket" role="UNKNOWN"/>
                    <XMRef idref="S1.Ex8.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMApp xml:id="S1.Ex8.m1.1">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="S1.Ex8.m1.1.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex8.m1.1.1">b</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="ket" role="UNKNOWN"/>
                        <XMRef idref="S1.Ex8.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">|</XMTok>
                        <XMTok meaning="0" role="NUMBER" xml:id="S1.Ex8.m1.2">0</XMTok>
                        <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">b</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="ket" role="UNKNOWN"/>
                        <XMRef idref="S1.Ex8.m1.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">|</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex8.m1.3">b</XMTok>
                        <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>For some <Math mode="inline" tex="b&gt;0" text="b &gt; 0" xml:id="S1.SS2.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math> and complex amplitudes <Math mode="inline" tex="c_{0}" text="c _ 0" xml:id="S1.SS2.p2.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">c</XMTok>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="c_{b}" text="c _ b" xml:id="S1.SS2.p2.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">c</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">b</XMTok>
              </XMApp>
            </XMath>
          </Math>.
To prepare such states, a sequence
<!--  %**** algo˙desc.tex Line 100 **** -->of CX gates, <Math mode="inline" tex="g_{1}g_{2}...g_{l}" text="g _ 1 * g _ 2 * ldots * g _ l" xml:id="S1.SS2.p2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">g</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">g</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMTok name="ldots" role="ID">…</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">g</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is used to move <Math mode="inline" tex="\ket{b}" text="ket@(b)" xml:id="S1.SS2.p2.m5">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p2.m5.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p2.m5.1">b</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> to a sequence of other
basis states, <Math mode="inline" tex="\ket{b_{1}}" text="ket@(b _ 1)" xml:id="S1.SS2.p2.m6">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p2.m6.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS2.p2.m6.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">b</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, <Math mode="inline" tex="\ket{b_{2}}" text="ket@(b _ 2)" xml:id="S1.SS2.p2.m7">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p2.m7.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS2.p2.m7.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">b</XMTok>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, …, <Math mode="inline" tex="\ket{b_{l}}" text="ket@(b _ l)" xml:id="S1.SS2.p2.m8">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p2.m8.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS2.p2.m8.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">b</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> such that</p>
        <equation xml:id="S1.Ex9">
          <Math mode="display" tex="g_{i}\ket{b_{i-1}}=\ket{b_{i}}\quad\text{for all}\quad 1\leq i\leq l,b_{0}=b" text="formulae@(formulae@(g _ i * ket@(b _ (i - 1)) = list@(ket@(b _ i), [for all]), 1 &lt;= i &lt;= l), b _ 0 = b)" xml:id="S1.Ex9.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="formulae"/>
                  <XMRef idref="S1.Ex9.m1.5"/>
                  <XMRef idref="S1.Ex9.m1.6"/>
                </XMApp>
                <XMWrap>
                  <XMDual xml:id="S1.Ex9.m1.5">
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="S1.Ex9.m1.5.1"/>
                      <XMRef idref="S1.Ex9.m1.5.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="S1.Ex9.m1.5.1">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">g</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="ket" role="UNKNOWN"/>
                              <XMRef idref="S1.Ex9.m1.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">|</XMTok>
                              <XMApp xml:id="S1.Ex9.m1.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">b</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S1.Ex9.m1.3"/>
                            <XMRef idref="S1.Ex9.m1.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMDual xml:id="S1.Ex9.m1.3">
                              <XMApp>
                                <XMTok meaning="ket" role="UNKNOWN"/>
                                <XMRef idref="S1.Ex9.m1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">|</XMTok>
                                <XMApp xml:id="S1.Ex9.m1.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">b</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMHint name="quad" role="PUNCT" width="10pt"/>
                            <XMText xml:id="S1.Ex9.m1.4">for all</XMText>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMHint name="quad" role="PUNCT" width="10pt"/>
                      <XMApp xml:id="S1.Ex9.m1.5.2">
                        <XMTok meaning="multirelation"/>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                        <XMTok font="italic" role="UNKNOWN">i</XMTok>
                        <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                        <XMTok font="italic" role="UNKNOWN">l</XMTok>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S1.Ex9.m1.6">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">b</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                    <XMTok font="italic" role="UNKNOWN">b</XMTok>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <equation xml:id="S1.Ex10">
          <Math mode="display" tex="b_{l}=2^{j}\quad\text{for some }j" text="b _ l = list@(2 ^ j, [for some ] * j)" xml:id="S1.Ex10.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">b</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="S1.Ex10.m1.1"/>
                    <XMRef idref="S1.Ex10.m1.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="S1.Ex10.m1.1">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                    </XMApp>
                    <XMHint name="quad" role="PUNCT" width="10pt"/>
                    <XMApp xml:id="S1.Ex10.m1.2">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMText>for some </XMText>
                      <XMTok font="italic" role="UNKNOWN">j</XMTok>
                    </XMApp>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>CX gates leave <Math mode="inline" tex="\ket{0}" text="ket@(0)" xml:id="S1.SS2.p2.m9">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p2.m9.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="S1.SS2.p2.m9.1">0</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> unchanged, therefore, this sequence of CX gates
transforms <Math mode="inline" tex="\ket{x^{\prime}(b)}" text="ket@(x ^ prime * b)" xml:id="S1.SS2.p2.m10">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p2.m10.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS2.p2.m10.1">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S1.SS2.p2.m10.1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p2.m10.1.1">b</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> to a new state:</p>
        <equation xml:id="S1.Ex11">
          <Math mode="display" tex="\ket{x^{\prime\prime}}=c_{0}\ket{0}+c_{b}\ket{2^{j}}" text="ket@(x ^ prime2) = c _ 0 * ket@(0) + c _ b * ket@(2 ^ j)" xml:id="S1.Ex11.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="ket" role="UNKNOWN"/>
                    <XMRef idref="S1.Ex11.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMApp xml:id="S1.Ex11.m1.1">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok fontsize="70%" name="prime2" role="SUPOP">′′</XMTok>
                    </XMApp>
                    <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="ket" role="UNKNOWN"/>
                        <XMRef idref="S1.Ex11.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">|</XMTok>
                        <XMTok meaning="0" role="NUMBER" xml:id="S1.Ex11.m1.2">0</XMTok>
                        <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">b</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="ket" role="UNKNOWN"/>
                        <XMRef idref="S1.Ex11.m1.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">|</XMTok>
                        <XMApp xml:id="S1.Ex11.m1.3">
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                        </XMApp>
                        <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>Which is a one-qubit state, and can be prepared using an RZ and RY gate [ref].
Let <Math mode="inline" tex="CXD(b)=l" text="C * X * D * b = l" xml:id="S1.SS2.p2.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">C</XMTok>
                  <XMTok font="italic" role="UNKNOWN">X</XMTok>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  <XMDual>
                    <XMRef idref="S1.SS2.p2.m11.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p2.m11.1">b</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok font="italic" role="UNKNOWN">l</XMTok>
              </XMApp>
            </XMath>
          </Math> be the minimum number of CX gates required to prepare
<Math mode="inline" tex="\ket{x^{\prime}}" text="ket@(x ^ prime)" xml:id="S1.SS2.p2.m12">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p2.m12.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS2.p2.m12.1">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>;
the formula for <Math mode="inline" tex="CXD(b)" text="C * X * D * b" xml:id="S1.SS2.p2.m13">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">C</XMTok>
                <XMTok font="italic" role="UNKNOWN">X</XMTok>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMRef idref="S1.SS2.p2.m13.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p2.m13.1">b</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is presented in the Appendix. Then, each CX gate <Math mode="inline" tex="g_{i}" text="g _ i" xml:id="S1.SS2.p2.m14">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math>
can be computed by selecting a CX gate such that <Math mode="inline" tex="CXD(b_{i})=CXD(b_{i-1})-1" text="C * X * D * b _ i = C * X * D * b _ (i - 1) - 1" xml:id="S1.SS2.p2.m15">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">C</XMTok>
                  <XMTok font="italic" role="UNKNOWN">X</XMTok>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  <XMDual>
                    <XMRef idref="S1.SS2.p2.m15.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S1.SS2.p2.m15.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">b</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">C</XMTok>
                    <XMTok font="italic" role="UNKNOWN">X</XMTok>
                    <XMTok font="italic" role="UNKNOWN">D</XMTok>
                    <XMDual>
                      <XMRef idref="S1.SS2.p2.m15.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S1.SS2.p2.m15.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">b</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S1.SS2.p3">
        <p>The Type 2 index subsets <Math mode="inline" tex="K^{(+)}(a,p)" text="K ^ + * open-interval@(a, p)" xml:id="S1.SS2.p3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">K</XMTok>
                  <XMDual>
                    <XMRef idref="S1.SS2.p3.m1.1"/>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok fontsize="70%" meaning="plus" role="ADDOP" xml:id="S1.SS2.p3.m1.1">+</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S1.SS2.p3.m1.2"/>
                    <XMRef idref="S1.SS2.p3.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p3.m1.2">a</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p3.m1.3">p</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> give rise to Type 2 quantum states of
the form:</p>
        <equation xml:id="S1.Ex12">
          <Math mode="display" tex="\ket{x^{\prime(+)}(a,p)}=(\ket{a}\otimes\ket{\psi_{1}}+\ket{0}\otimes\ket{\psi%&#10;_{2}})\otimes\ket{0_{p}}" text="ket@(x ^ (list@(prime1, +)) * open-interval@(a, p)) = (ket@(a) tensor-product ket@(psi _ 1) + ket@(0) tensor-product ket@(psi _ 2)) tensor-product ket@(0 _ p)" xml:id="S1.Ex12.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="ket" role="UNKNOWN"/>
                    <XMRef idref="S1.Ex12.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMApp xml:id="S1.Ex12.m1.1">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S1.Ex12.m1.1.2"/>
                            <XMRef idref="S1.Ex12.m1.1.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok name="prime1" role="SUPOP" xml:id="S1.Ex12.m1.1.2">′</XMTok>
                            <XMTok role="PUNCT">⁣</XMTok>
                            <XMDual xml:id="S1.Ex12.m1.1.3">
                              <XMRef idref="S1.Ex12.m1.1.1"/>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok fontsize="70%" meaning="plus" role="ADDOP" xml:id="S1.Ex12.m1.1.1">+</XMTok>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S1.Ex12.m1.1.4"/>
                          <XMRef idref="S1.Ex12.m1.1.5"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex12.m1.1.4">a</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex12.m1.1.5">p</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok meaning="tensor-product" name="otimes" role="MULOP">⊗</XMTok>
                  <XMDual>
                    <XMRef idref="S1.Ex12.m1.7"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S1.Ex12.m1.7">
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="tensor-product" name="otimes" role="MULOP">⊗</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="ket" role="UNKNOWN"/>
                              <XMRef idref="S1.Ex12.m1.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">|</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex12.m1.2">a</XMTok>
                              <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="ket" role="UNKNOWN"/>
                              <XMRef idref="S1.Ex12.m1.3"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">|</XMTok>
                              <XMApp xml:id="S1.Ex12.m1.3">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="psi" role="UNKNOWN">ψ</XMTok>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="tensor-product" name="otimes" role="MULOP">⊗</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="ket" role="UNKNOWN"/>
                              <XMRef idref="S1.Ex12.m1.4"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">|</XMTok>
                              <XMTok meaning="0" role="NUMBER" xml:id="S1.Ex12.m1.4">0</XMTok>
                              <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="ket" role="UNKNOWN"/>
                              <XMRef idref="S1.Ex12.m1.5"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">|</XMTok>
                              <XMApp xml:id="S1.Ex12.m1.5">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="psi" role="UNKNOWN">ψ</XMTok>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="ket" role="UNKNOWN"/>
                      <XMRef idref="S1.Ex12.m1.6"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMApp xml:id="S1.Ex12.m1.6">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok meaning="0" role="NUMBER">0</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                      </XMApp>
                      <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>.
Where <Math mode="inline" tex="\ket{\psi_{1}}" text="ket@(psi _ 1)" xml:id="S1.SS2.p3.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p3.m2.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS2.p3.m2.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="psi" role="UNKNOWN">ψ</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> and <Math mode="inline" tex="\ket{\psi_{2}}" text="ket@(psi _ 2)" xml:id="S1.SS2.p3.m3">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p3.m3.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS2.p3.m3.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="psi" role="UNKNOWN">ψ</XMTok>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> are non-normalized, two-qubit states and
<Math mode="inline" tex="\ket{0_{p}}" text="ket@(0 _ p)" xml:id="S1.SS2.p3.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p3.m4.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS2.p3.m4.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="0" role="NUMBER">0</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> represents all zeroes in the lowest <Math mode="inline" tex="p" text="p" xml:id="S1.SS2.p3.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
            </XMath>
          </Math> qubits. To prepare such
states, a sequence of CX gates, <Math mode="inline" tex="g_{1}g_{2}...g_{m}" text="g _ 1 * g _ 2 * ldots * g _ m" xml:id="S1.SS2.p3.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">g</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">g</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMTok name="ldots" role="ID">…</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">g</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> are applied to the upper
<Math mode="inline" tex="n-p-2" text="n - p - 2" xml:id="S1.SS2.p3.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> qubits to transform
<Math mode="inline" tex="\ket{a}" text="ket@(a)" xml:id="S1.SS2.p3.m8">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p3.m8.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p3.m8.1">a</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> to a sequence of other basis states,
<Math mode="inline" tex="\ket{a_{1}}" text="ket@(a _ 1)" xml:id="S1.SS2.p3.m9">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p3.m9.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS2.p3.m9.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, <Math mode="inline" tex="\ket{a_{2}}" text="ket@(a _ 2)" xml:id="S1.SS2.p3.m10">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p3.m10.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS2.p3.m10.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, …, <Math mode="inline" tex="\ket{a_{m}}" text="ket@(a _ m)" xml:id="S1.SS2.p3.m11">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p3.m11.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS2.p3.m11.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> such that</p>
        <equation xml:id="S1.Ex13">
          <Math mode="display" tex="g_{i}\ket{a_{i-1}}=\ket{a_{i}}\quad\text{for all}\quad 1\leq i\leq m,\ket{a_{0%&#10;}}=\ket{a}" text="formulae@(formulae@(g _ i * ket@(a _ (i - 1)) = list@(ket@(a _ i), [for all]), 1 &lt;= i &lt;= m), ket@(a _ 0) = ket@(a))" xml:id="S1.Ex13.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="formulae"/>
                  <XMRef idref="S1.Ex13.m1.7"/>
                  <XMRef idref="S1.Ex13.m1.8"/>
                </XMApp>
                <XMWrap>
                  <XMDual xml:id="S1.Ex13.m1.7">
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="S1.Ex13.m1.7.1"/>
                      <XMRef idref="S1.Ex13.m1.7.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="S1.Ex13.m1.7.1">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">g</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="ket" role="UNKNOWN"/>
                              <XMRef idref="S1.Ex13.m1.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">|</XMTok>
                              <XMApp xml:id="S1.Ex13.m1.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S1.Ex13.m1.5"/>
                            <XMRef idref="S1.Ex13.m1.6"/>
                          </XMApp>
                          <XMWrap>
                            <XMDual xml:id="S1.Ex13.m1.5">
                              <XMApp>
                                <XMTok meaning="ket" role="UNKNOWN"/>
                                <XMRef idref="S1.Ex13.m1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">|</XMTok>
                                <XMApp xml:id="S1.Ex13.m1.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMHint name="quad" role="PUNCT" width="10pt"/>
                            <XMText xml:id="S1.Ex13.m1.6">for all</XMText>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMHint name="quad" role="PUNCT" width="10pt"/>
                      <XMApp xml:id="S1.Ex13.m1.7.2">
                        <XMTok meaning="multirelation"/>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                        <XMTok font="italic" role="UNKNOWN">i</XMTok>
                        <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                        <XMTok font="italic" role="UNKNOWN">m</XMTok>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S1.Ex13.m1.8">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="ket" role="UNKNOWN"/>
                        <XMRef idref="S1.Ex13.m1.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">|</XMTok>
                        <XMApp xml:id="S1.Ex13.m1.3">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                        </XMApp>
                        <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="ket" role="UNKNOWN"/>
                        <XMRef idref="S1.Ex13.m1.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">|</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex13.m1.4">a</XMTok>
                        <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <equation xml:id="S1.Ex14">
          <Math mode="display" tex="\ket{a_{m}}=\ket{1}" text="ket@(a _ m) = ket@(1)" xml:id="S1.Ex14.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="ket" role="UNKNOWN"/>
                    <XMRef idref="S1.Ex14.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMApp xml:id="S1.Ex14.m1.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                    </XMApp>
                    <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                  </XMWrap>
                </XMDual>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="ket" role="UNKNOWN"/>
                    <XMRef idref="S1.Ex14.m1.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok meaning="1" role="NUMBER" xml:id="S1.Ex14.m1.2">1</XMTok>
                    <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>Again, CX gates leave <Math mode="inline" tex="\ket{0}" text="ket@(0)" xml:id="S1.SS2.p3.m12">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p3.m12.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="S1.SS2.p3.m12.1">0</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> unchanged, so this sequence transforms <Math mode="inline" tex="\ket{x^{\prime(+)}(a,p)}" text="ket@(x ^ (list@(prime1, +)) * open-interval@(a, p))" xml:id="S1.SS2.p3.m13">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p3.m13.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS2.p3.m13.1">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="S1.SS2.p3.m13.1.2"/>
                          <XMRef idref="S1.SS2.p3.m13.1.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok name="prime1" role="SUPOP" xml:id="S1.SS2.p3.m13.1.2">′</XMTok>
                          <XMTok role="PUNCT">⁣</XMTok>
                          <XMDual xml:id="S1.SS2.p3.m13.1.3">
                            <XMRef idref="S1.SS2.p3.m13.1.1"/>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok fontsize="70%" meaning="plus" role="ADDOP" xml:id="S1.SS2.p3.m13.1.1">+</XMTok>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S1.SS2.p3.m13.1.4"/>
                        <XMRef idref="S1.SS2.p3.m13.1.5"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p3.m13.1.4">a</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p3.m13.1.5">p</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> to
<!--  %**** algo˙desc.tex Line 125 **** --></p>
        <equation xml:id="S1.Ex15">
          <Math mode="display" tex="\ket{x^{\prime\prime(+)}}=(\ket{1}\otimes\ket{\psi_{1}}+\ket{0}\otimes\ket{%&#10;\psi_{2}})\otimes\ket{0_{p}}" text="ket@(x ^ (list@(prime2, +))) = (ket@(1) tensor-product ket@(psi _ 1) + ket@(0) tensor-product ket@(psi _ 2)) tensor-product ket@(0 _ p)" xml:id="S1.Ex15.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="ket" role="UNKNOWN"/>
                    <XMRef idref="S1.Ex15.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMApp xml:id="S1.Ex15.m1.1">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="S1.Ex15.m1.1.2"/>
                          <XMRef idref="S1.Ex15.m1.1.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok name="prime2" role="SUPOP" xml:id="S1.Ex15.m1.1.2">′′</XMTok>
                          <XMTok role="PUNCT">⁣</XMTok>
                          <XMDual xml:id="S1.Ex15.m1.1.3">
                            <XMRef idref="S1.Ex15.m1.1.1"/>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok fontsize="70%" meaning="plus" role="ADDOP" xml:id="S1.Ex15.m1.1.1">+</XMTok>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok meaning="tensor-product" name="otimes" role="MULOP">⊗</XMTok>
                  <XMDual>
                    <XMRef idref="S1.Ex15.m1.7"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S1.Ex15.m1.7">
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="tensor-product" name="otimes" role="MULOP">⊗</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="ket" role="UNKNOWN"/>
                              <XMRef idref="S1.Ex15.m1.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">|</XMTok>
                              <XMTok meaning="1" role="NUMBER" xml:id="S1.Ex15.m1.2">1</XMTok>
                              <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="ket" role="UNKNOWN"/>
                              <XMRef idref="S1.Ex15.m1.3"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">|</XMTok>
                              <XMApp xml:id="S1.Ex15.m1.3">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="psi" role="UNKNOWN">ψ</XMTok>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="tensor-product" name="otimes" role="MULOP">⊗</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="ket" role="UNKNOWN"/>
                              <XMRef idref="S1.Ex15.m1.4"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">|</XMTok>
                              <XMTok meaning="0" role="NUMBER" xml:id="S1.Ex15.m1.4">0</XMTok>
                              <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="ket" role="UNKNOWN"/>
                              <XMRef idref="S1.Ex15.m1.5"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">|</XMTok>
                              <XMApp xml:id="S1.Ex15.m1.5">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="psi" role="UNKNOWN">ψ</XMTok>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="ket" role="UNKNOWN"/>
                      <XMRef idref="S1.Ex15.m1.6"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMApp xml:id="S1.Ex15.m1.6">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok meaning="0" role="NUMBER">0</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                      </XMApp>
                      <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>The result is a three-qubit state, which can be prepared exactly using three CX
gates [ref]. We give our construction for linear nearest neighbor architectures
in the Appendix. In addition, let <Math mode="inline" tex="CXD^{(+)}(p)=m" text="C * X * D ^ + * p = m" xml:id="S1.SS2.p3.m14">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">C</XMTok>
                  <XMTok font="italic" role="UNKNOWN">X</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">D</XMTok>
                    <XMDual>
                      <XMRef idref="S1.SS2.p3.m14.1"/>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok fontsize="70%" meaning="plus" role="ADDOP" xml:id="S1.SS2.p3.m14.1">+</XMTok>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S1.SS2.p3.m14.2"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p3.m14.2">p</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
              </XMApp>
            </XMath>
          </Math> be the minimum number of
CX gates required to transform <Math mode="inline" tex="\ket{a}" text="ket@(a)" xml:id="S1.SS2.p3.m15">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p3.m15.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p3.m15.1">a</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> to <Math mode="inline" tex="\ket{1}" text="ket@(1)" xml:id="S1.SS2.p3.m16">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p3.m16.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok meaning="1" role="NUMBER" xml:id="S1.SS2.p3.m16.1">1</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>; the formula for
<Math mode="inline" tex="CXD^{(+)}" text="C * X * D ^ +" xml:id="S1.SS2.p3.m17">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">C</XMTok>
                <XMTok font="italic" role="UNKNOWN">X</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  <XMDual>
                    <XMRef idref="S1.SS2.p3.m17.1"/>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok fontsize="70%" meaning="plus" role="ADDOP" xml:id="S1.SS2.p3.m17.1">+</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is given in the Appendix.</p>
      </para>
      <para xml:id="S1.SS2.p4">
        <p>In the special case where <Math mode="inline" tex="a=0" text="a = 0" xml:id="S1.SS2.p4.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>, the index subset <Math mode="inline" tex="K^{(+)}(a,p)" text="K ^ + * open-interval@(a, p)" xml:id="S1.SS2.p4.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">K</XMTok>
                  <XMDual>
                    <XMRef idref="S1.SS2.p4.m2.1"/>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok fontsize="70%" meaning="plus" role="ADDOP" xml:id="S1.SS2.p4.m2.1">+</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S1.SS2.p4.m2.2"/>
                    <XMRef idref="S1.SS2.p4.m2.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p4.m2.2">a</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p4.m2.3">p</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> gives rise
to a two qubit state:</p>
        <equation xml:id="S1.Ex16">
          <Math mode="display" tex="\ket{x^{\prime}}=\ket{0_{n-p-2}}\otimes\ket{\psi_{0}}\otimes\ket{0_{p}}" text="ket@(x ^ prime) = ket@(0 _ (n - p - 2)) tensor-product ket@(psi _ 0) tensor-product ket@(0 _ p)" xml:id="S1.Ex16.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="ket" role="UNKNOWN"/>
                    <XMRef idref="S1.Ex16.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMApp xml:id="S1.Ex16.m1.1">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                    </XMApp>
                    <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok meaning="tensor-product" name="otimes" role="MULOP">⊗</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="ket" role="UNKNOWN"/>
                      <XMRef idref="S1.Ex16.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMApp xml:id="S1.Ex16.m1.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok meaning="0" role="NUMBER">0</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="ket" role="UNKNOWN"/>
                      <XMRef idref="S1.Ex16.m1.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMApp xml:id="S1.Ex16.m1.3">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="psi" role="UNKNOWN">ψ</XMTok>
                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                      </XMApp>
                      <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="ket" role="UNKNOWN"/>
                      <XMRef idref="S1.Ex16.m1.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMApp xml:id="S1.Ex16.m1.4">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok meaning="0" role="NUMBER">0</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                      </XMApp>
                      <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>Which can be prepared using one CX gate [ref].</p>
      </para>
      <para xml:id="S1.SS2.p5">
        <p>The Type 2 index subsets <Math mode="inline" tex="K^{(-)}(a,p)" text="K ^ - * open-interval@(a, p)" xml:id="S1.SS2.p5.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">K</XMTok>
                  <XMDual>
                    <XMRef idref="S1.SS2.p5.m1.1"/>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP" xml:id="S1.SS2.p5.m1.1">-</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S1.SS2.p5.m1.2"/>
                    <XMRef idref="S1.SS2.p5.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p5.m1.2">a</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p5.m1.3">p</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> give rise to quantum states of the form</p>
        <equation xml:id="S1.Ex17">
          <Math class="ltx_math_unparsed" mode="display" tex="\ket{x^{\prime(-)}(a,p)}=\ket{0_{n-p-2}}\otimes(\ket{\psi_{1}}\otimes\ket{a}+%&#10;\otimes\ket{\psi_{2}}\otimes\ket{0})" xml:id="S1.Ex17.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.Ex17.m1.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.Ex17.m1.1">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="S1.Ex17.m1.1.2"/>
                          <XMRef idref="S1.Ex17.m1.1.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok name="prime1" role="SUPOP" xml:id="S1.Ex17.m1.1.2">′</XMTok>
                          <XMTok role="PUNCT">⁣</XMTok>
                          <XMDual xml:id="S1.Ex17.m1.1.3">
                            <XMRef idref="S1.Ex17.m1.1.1"/>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP" xml:id="S1.Ex17.m1.1.1">-</XMTok>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S1.Ex17.m1.1.4"/>
                        <XMRef idref="S1.Ex17.m1.1.5"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex17.m1.1.4">a</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex17.m1.1.5">p</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.Ex17.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.Ex17.m1.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="0" role="NUMBER">0</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
              <XMTok meaning="tensor-product" name="otimes" role="MULOP">⊗</XMTok>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="ket" role="UNKNOWN"/>
                    <XMRef idref="S1.Ex17.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMApp xml:id="S1.Ex17.m1.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="psi" role="UNKNOWN">ψ</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok meaning="tensor-product" name="otimes" role="MULOP">⊗</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="ket" role="UNKNOWN"/>
                    <XMRef idref="S1.Ex17.m1.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex17.m1.4">a</XMTok>
                    <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                <XMTok meaning="tensor-product" name="otimes" role="MULOP">⊗</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="ket" role="UNKNOWN"/>
                    <XMRef idref="S1.Ex17.m1.5"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMApp xml:id="S1.Ex17.m1.5">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="psi" role="UNKNOWN">ψ</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok meaning="tensor-product" name="otimes" role="MULOP">⊗</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="ket" role="UNKNOWN"/>
                    <XMRef idref="S1.Ex17.m1.6"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S1.Ex17.m1.6">0</XMTok>
                    <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
            </XMath>
          </Math>
        </equation>
        <p>Where <Math mode="inline" tex="\ket{\psi_{1}}" text="ket@(psi _ 1)" xml:id="S1.SS2.p5.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p5.m2.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS2.p5.m2.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="psi" role="UNKNOWN">ψ</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, <Math mode="inline" tex="\ket{\psi_{2}}" text="ket@(psi _ 2)" xml:id="S1.SS2.p5.m3">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p5.m3.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS2.p5.m3.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="psi" role="UNKNOWN">ψ</XMTok>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, and <Math mode="inline" tex="\ket{0_{n-p-2}}" text="ket@(0 _ (n - p - 2))" xml:id="S1.SS2.p5.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS2.p5.m4.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS2.p5.m4.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="0" role="NUMBER">0</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> are defined as in
the <Math mode="inline" tex="K^{(+)}(a,p)" text="K ^ + * open-interval@(a, p)" xml:id="S1.SS2.p5.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">K</XMTok>
                  <XMDual>
                    <XMRef idref="S1.SS2.p5.m5.1"/>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok fontsize="70%" meaning="plus" role="ADDOP" xml:id="S1.SS2.p5.m5.1">+</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S1.SS2.p5.m5.2"/>
                    <XMRef idref="S1.SS2.p5.m5.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p5.m5.2">a</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS2.p5.m5.3">p</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> case. Note that these states are the same as those in
[ref equation], but with the qubits in reverse order. Thus, the same state
preparation method applies to this case.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S1.SS3">
      <tags>
        <tag>1.3</tag>
        <tag role="refnum">1.3</tag>
        <tag role="typerefnum">§1.3</tag>
      </tags>
      <title><tag close=" ">1.3</tag>Implementing Adapt</title>
      <para xml:id="S1.SS3.p1">
        <p>If <Math mode="inline" tex="K" text="K" xml:id="S1.SS3.p1.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">K</XMTok>
            </XMath>
          </Math> is a Type 1 index subset, then the corresponding sparse approximation
takes the form</p>
        <equation xml:id="S1.Ex18">
          <Math mode="display" tex="\ket{x^{\prime}}=c_{0}\ket{0}+c_{b}\ket{b}" text="ket@(x ^ prime) = c _ 0 * ket@(0) + c _ b * ket@(b)" xml:id="S1.Ex18.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="ket" role="UNKNOWN"/>
                    <XMRef idref="S1.Ex18.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMApp xml:id="S1.Ex18.m1.1">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                    </XMApp>
                    <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="ket" role="UNKNOWN"/>
                        <XMRef idref="S1.Ex18.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">|</XMTok>
                        <XMTok meaning="0" role="NUMBER" xml:id="S1.Ex18.m1.2">0</XMTok>
                        <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">b</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="ket" role="UNKNOWN"/>
                        <XMRef idref="S1.Ex18.m1.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">|</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S1.Ex18.m1.3">b</XMTok>
                        <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>.
And the state preparation method involves applying CX gates to move <Math mode="inline" tex="\ket{b}" text="ket@(b)" xml:id="S1.SS3.p1.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS3.p1.m2.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS3.p1.m2.1">b</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> to
<Math mode="inline" tex="\ket{2^{i}}" text="ket@(2 ^ i)" xml:id="S1.SS3.p1.m3">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS3.p1.m3.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS3.p1.m3.1">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, before applying a one-qubit state preparation procedure. To adapt
this to refining <Math mode="inline" tex="\ket{x}" text="ket@(x)" xml:id="S1.SS3.p1.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS3.p1.m4.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS3.p1.m4.1">x</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, we re-imagine the process of moving <Math mode="inline" tex="\ket{b}" text="ket@(b)" xml:id="S1.SS3.p1.m5">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS3.p1.m5.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS3.p1.m5.1">b</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> using
<!--  %**** algo˙desc.tex Line 150 **** -->CX gates as an iterative merging procedure using CX, RZ, and RY gates. If <Math mode="inline" tex="b" text="b" xml:id="S1.SS3.p1.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">b</XMTok>
            </XMath>
          </Math>
and <Math mode="inline" tex="b^{\prime}" text="b ^ prime" xml:id="S1.SS3.p1.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math> are two length-<Math mode="inline" tex="n" text="n" xml:id="S1.SS3.p1.m8">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">n</XMTok>
            </XMath>
          </Math> bitstrings that differ in only the <Math mode="inline" tex="i" text="i" xml:id="S1.SS3.p1.m9">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">i</XMTok>
            </XMath>
          </Math>th bit and
both <Math mode="inline" tex="b" text="b" xml:id="S1.SS3.p1.m10">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">b</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="b^{\prime}" text="b ^ prime" xml:id="S1.SS3.p1.m11">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math> have a 1 at position <Math mode="inline" tex="j" text="j" xml:id="S1.SS3.p1.m12">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">j</XMTok>
            </XMath>
          </Math> for <Math mode="inline" tex="|i-j|=1" text="absolute-value@(i - j) = 1" xml:id="S1.SS3.p1.m13">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="S1.SS3.p1.m13.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMApp xml:id="S1.SS3.p1.m13.1">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" role="UNKNOWN">i</XMTok>
                      <XMTok font="italic" role="UNKNOWN">j</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>, then
the amplitude at <Math mode="inline" tex="\ket{b}" text="ket@(b)" xml:id="S1.SS3.p1.m14">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS3.p1.m14.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS3.p1.m14.1">b</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> can be merged into the amplitude at <Math mode="inline" tex="\ket{b^{\prime}}" text="ket@(b ^ prime)" xml:id="S1.SS3.p1.m15">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS3.p1.m15.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS3.p1.m15.1">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">b</XMTok>
                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> using
the following procedure:</p>
      </para>
      <para xml:id="S1.SS3.p2">
        <p>[subroutine description]</p>
      </para>
      <para xml:id="S1.SS3.p3">
        <p>Granted, this procedure will generally shuffle the amplitudes of many other
bases, but it leaves the amplitude at <Math mode="inline" tex="\ket{0}" text="ket@(0)" xml:id="S1.SS3.p3.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS3.p3.m1.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="S1.SS3.p3.m1.1">0</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> unchanged (up to a phase). Then,
the procedure for adapting <Math mode="inline" tex="\ket{x^{\prime}}" text="ket@(x ^ prime)" xml:id="S1.SS3.p3.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS3.p3.m2.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S1.SS3.p3.m2.1">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                  </XMApp>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> for refining <Math mode="inline" tex="\ket{x}" text="ket@(x)" xml:id="S1.SS3.p3.m3">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS3.p3.m3.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS3.p3.m3.1">x</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> is:</p>
      </para>
      <para xml:id="S1.SS3.p4">
        <p>[Refinement by ISA, Type 1]</p>
      </para>
      <para xml:id="S1.SS3.p5">
        <p>At each iteration, the algorithm constructs a list of all possible CX gates that
modify <Math mode="inline" tex="\ket{b}" text="ket@(b)" xml:id="S1.SS3.p5.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="ket" role="UNKNOWN"/>
                  <XMRef idref="S1.SS3.p5.m1.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS3.p5.m1.1">b</XMTok>
                  <XMTok name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>. For each propective CX gate, the projected fidelity increase
ratio is updated, and the maximal fidelity increase ratio is selected.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S1.SS4">
      <tags>
        <tag>1.4</tag>
        <tag role="refnum">1.4</tag>
        <tag role="typerefnum">§1.4</tag>
      </tags>
      <title><tag close=" ">1.4</tag>Refinement by RZ-RY</title>
      <para xml:id="S1.SS4.p1">
        <p>Copy and paste from original text?
then</p>
      </para>
      <para xml:id="S1.SS4.p2">
        <p>Our specific implementation of the ISA framework is summarized in Algorithm 2.
[pseudo-code for specific ISA implementation].</p>
      </para>
    </subsection>
  </section>
</document>
